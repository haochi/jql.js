!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.JQL=e()}}(function(){return function e(t,n,o){function i(u,c){if(!n[u]){if(!t[u]){var f="function"==typeof require&&require;if(!c&&f)return f(u,!0);if(r)return r(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return i(n?n:e)},a,a.exports,e,t,n,o)}return n[u].exports}for(var r="function"==typeof require&&require,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(e,t,n){"use strict";var o=e("./query/Query"),i=function(){function e(e){this.rows=e}return e.prototype.query=function(){var e=new o.Query;return e.from(this),e},e.prototype.all=function(){return this.rows},e}();n.Table=i},{"./query/Query":4}],2:[function(e,t,n){"use strict";var o=e("./Query"),i=e("./JoinType"),r=function(){function e(t,n,o){this.otherTable=t,this.predicate=n,this.joinType=o,this.joinStrategies=new Map([[i.JoinType.INNER,e.innerJoin],[i.JoinType.LEFT,e.leftJoin],[i.JoinType.RIGHT,e.rightJoin]])}return e.prototype.execute=function(e){var t=this.joinStrategies.get(this.joinType);return t(e,this.otherTable,this.predicate)},e.innerJoin=function(e,t,n){var o=[];return e.forEach(function(e){t.table.all().forEach(function(i){var r=e.copy();r.set(t,i),n(r)&&o.push(r)})}),o},e.leftJoin=function(e,t,n){var o=[];return e.forEach(function(e){var i=!1;t.table.all().forEach(function(r){var u=e.copy();u.set(t,r),n(u)&&(o.push(u),i=!0)}),i||o.push(e)}),o},e.rightJoin=function(e,t,n){var i=[];return t.table.all().forEach(function(r){var u=!1;if(e.forEach(function(e){var o=e.copy();o.set(t,r),n(o)&&(i.push(o),u=!0)}),!u){var c=new o.TableRowReference;c.set(t,r),i.push(c)}}),i},e}();n.JoinExecution=r},{"./JoinType":3,"./Query":4}],3:[function(e,t,n){"use strict";var o;!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.INNER=2]="INNER"}(o=n.JoinType||(n.JoinType={}))},{}],4:[function(e,t,n){"use strict";var o=e("../Table"),i=e("./JoinExecution"),r=e("./WhereExecution"),u=e("./JoinType"),c=function(){function e(){this.executions=[],this.tableReferences=new Map,this.selector=function(e){return[]}}return e.prototype.select=function(e){return this.selector=e,this},e.prototype.join=function(e,t,n){void 0===n&&(n=u.JoinType.INNER);var o=new i.JoinExecution(this.tableToTableSelection(e),t,n);return this.executions.push(o),this},e.prototype.where=function(e){return this.executions.push(new r.WhereExecution(e)),this},e.prototype.limit=function(e){return this.take=e,this},e.prototype.offset=function(e){return this.skip=e,this},e.prototype.from=function(e){return this.anchorTable=this.tableToTableSelection(e),this},e.prototype.execute=function(){var e=this.anchorTable,t=e.table.all().map(function(t){var n=new s;return n.set(e,t),n});return this.executions.forEach(function(e){t=e.execute(t)}),void 0!==this.skip&&(t=t.slice(this.skip)),void 0!==this.take&&(t.length=this.take),t.map(this.selector)},e.prototype.tableToTableSelection=function(e){return e instanceof o.Table?new f(e):e},e}();n.Query=c;var f=function(){function e(e,t){void 0===t&&(t=null),this.table=e,this.as=t}return e}();n.TableSelection=f;var s=function(){function e(){this.tableReference=new Map}return e.prototype.table=function(e,t){return void 0===t&&(t=null),null===t?this.tableReference.get(e):this.column(e,t)},e.prototype.set=function(e,t){e.as&&this.tableReference.set(e.as,t),this.tableReference.set(e.table,t)},e.prototype.copy=function(){var t=new e;return this.tableReference.forEach(function(e,n){return t.tableReference.set(n,e)}),t},e.prototype.clear=function(){this.tableReference.clear()},e.prototype.column=function(e,t){var n=this.table(e);return n?t(n):null},e}();n.TableRowReference=s},{"../Table":1,"./JoinExecution":2,"./JoinType":3,"./WhereExecution":5}],5:[function(e,t,n){"use strict";var o=function(){function e(e){this.predicate=e}return e.prototype.execute=function(e){return e.filter(this.predicate)},e}();n.WhereExecution=o},{}]},{},[1])(1)});
//# sourceMappingURL=jql.js.map